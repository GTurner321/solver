<script>
    let score = 0;
    const scoreElement = document.getElementById("score");
    const correctAnswers = {
        "symbol-1": "-",
        "number-1": "1",
        "symbol-2": "รท",
        "number-2": "2",
    };

    function revealEquation2() {
        document.getElementById("equation-2-container").style.display = "block";
    }

    document.querySelectorAll(".draggable").forEach(draggable => {
        draggable.addEventListener("dragstart", event => {
            event.dataTransfer.setData("text", event.target.textContent);
        });
    });

    document.querySelectorAll(".drop-box").forEach(box => {
        box.addEventListener("dragover", event => {
            event.preventDefault();
        });

        box.addEventListener("drop", event => {
            event.preventDefault();
            const droppedValue = event.dataTransfer.getData("text");
            const pair = box.getAttribute("data-pair");

            if (correctAnswers[pair] === droppedValue) {
                box.textContent = droppedValue;

                // Ensure all matching boxes get the correct value
                document.querySelectorAll(`.drop-box[data-pair='${pair}']`).forEach(b => {
                    b.textContent = droppedValue;
                });

                // Check if all boxes for this stage are filled
                const stage = pair.split("-")[1]; // Extract stage (1 or 2)
                const allBoxes = document.querySelectorAll(`.drop-box[data-pair^='symbol-${stage}'], .drop-box[data-pair^='number-${stage}']`);
                const allFilled = [...allBoxes].every(b => b.textContent.trim() !== "");

                if (allFilled) {
                    const message = document.getElementById(`message-${stage}`);
                    message.textContent = "Correct!";
                    message.classList.add("correct");

                    if (score === 0) {
                        // First stage complete
                        score = 5;
                        scoreElement.textContent = `Score = ${score}`;
                        setTimeout(revealEquation2, 1000); // Reveal next stage
                    } else if (score === 5) {
                        // Second stage complete
                        score = 10;
                        scoreElement.textContent = `Score = ${score}`;
                        document.getElementById("equation-3-container").style.display = "block";
                        document.getElementById("final-message").textContent = "Well done! You have solved the equation.";
                    }
                }
            } else {
                // Incorrect drop
                const message = document.getElementById(`message-${pair.split("-")[1]}`);
                message.textContent = "Try again!";
                message.classList.add("try-again");
            }
        });
    });
</script>
